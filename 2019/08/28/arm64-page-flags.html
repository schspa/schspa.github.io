<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-03-03 Thu 11:48 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ARM64 Page type</title>
<meta name="author" content="schspa" />
<meta name="description" content="arm64-page-flags.org" />
<meta name="keywords" content="GRE nGnRnE" />
<meta name="generator" content="Org Mode" />
<link rel="shortcut icon" href="/images/rose-red.png" type="image/x-icon" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" integrity="sha256-sAcc18zvMnaJZrNT4v8J0T4HqzEUiUTlVFgDIywjQek=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/animate.min.css" />
<link rel="stylesheet" href="/css/all.min.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css" />
<link rel="stylesheet" type="text/css" href="/css/navbar.css" />
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.min.js" integrity="sha256-/hGxZHGQ57fXLp+NDusFZsZo/PG21Bp2+hXYV5a6w+g=" crossorigin="anonymous"></script>
<script src="/js/jquery.min.js"></script>
<script src="/js/darkreader.js"></script>
<script src="/user.config.js"></script>
<script src="/js/main.js"></script>
</head>
<body>
<div id="preamble" class="status">
<div class="mobile-container">
  <!-- Top Navigation Menu -->
  <div class="topnav">
    <div id="header">
      <a href="/" class="logo">Schspa's Blog</a>
      <a href="javascript:void(0);" class="icon" onclick="toggleheader()">
        <i class="fa fa-bars"></i>
      </a>
    </div>
    <div id="nav_headers">
      <a href="/sitemap.html" class="menu-item">Categories</a>
    </div>
  </div>
  <!-- End smartphone / tablet look -->
</div>

<header id="header" class="header">
  <div class="logo-wrapper">
    <a href="/" class="logo">Schspa's Blogs</a>
  </div>

  <nav class="site-navbar">
    <ul id="menu" class="menu">
      <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li>
      <li class="menu-item">
        <a class="menu-item-link" href="/sitemap.html">Categories</a>
      </li>
    </ul>
  </nav>
</header>
</div>
<div id="content" class="content">
<h1 class="title">ARM64 Page type</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org5574f37">æŸ¥çœ‹å†…å­˜å±æ€§</a></li>
<li><a href="#orga75da86">ä¸¤ç§pagetype</a>
<ul>
<li><a href="#orgc449c56">æŒ‡å®šå†…å­˜ç±»å‹</a></li>
<li><a href="#org9e0fab0">Normal Memory</a></li>
<li><a href="#org4b45c3a">Device Memory</a></li>
<li><a href="#org54576f0">Strongly Ordered Memory :: ARMv7 platform, merge into Device Memory</a></li>
</ul>
</li>
<li><a href="#orgaa3fb81">MMU table</a>
<ul>
<li><a href="#orgeb7c5a0">Input Address size limit.</a></li>
<li><a href="#org3620f1d">Translate table</a></li>
<li><a href="#org6fbc205">example</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org5574f37" class="outline-2">
<h2 id="org5574f37">æŸ¥çœ‹å†…å­˜å±æ€§</h2>
<div class="outline-text-2" id="text-org5574f37">

<div id="org70b861f" class="figure">
<p><img src="assets/find-aarch64-memory-attr.png" alt="find-aarch64-memory-attr.png"><br>
</p>
</div>
</div>
</div>

<div id="outline-container-orga75da86" class="outline-2">
<h2 id="orga75da86">ä¸¤ç§pagetype</h2>
<div class="outline-text-2" id="text-orga75da86">
<p>
åœ¨ARM64ä¸­ï¼Œå…±åˆ†ä¸¤ç§å†…å­˜ç±»å‹<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup><br>
</p>
</div>

<div id="outline-container-orgc449c56" class="outline-3">
<h3 id="orgc449c56">æŒ‡å®šå†…å­˜ç±»å‹</h3>
<div class="outline-text-3" id="text-orgc449c56">
<p>
How does system distinguish memory types?<br>
table entry[4:2] -&gt; MAIR(Memory Attribute Indirection Register) -&gt; Attr&lt;n&gt;[7:4] -&gt; Device Memory or Normal Memory<br>
<img src="assets/arm64-memory-types.png" alt="arm64-memory-types.png"><br>
</p>

<div class="org-src-container">
<pre class="src src-C"><code><span style="color: #5B6268;">/*</span></code>
<code><span style="color: #5B6268;"> * Memory types available.</span></code>
<code><span style="color: #5B6268;"> */</span></code>
<code><span style="color: #51afef; font-weight: bold;">#define</span> <span style="color: #dcaeea;">MT_DEVICE_nGnRnE</span>        0</code>
<code><span style="color: #51afef; font-weight: bold;">#define</span> <span style="color: #dcaeea;">MT_DEVICE_nGnRE</span>         1</code>
<code><span style="color: #51afef; font-weight: bold;">#define</span> <span style="color: #dcaeea;">MT_DEVICE_GRE</span>           2</code>
<code><span style="color: #51afef; font-weight: bold;">#define</span> <span style="color: #dcaeea;">MT_NORMAL_NC</span>            3</code>
<code><span style="color: #51afef; font-weight: bold;">#define</span> <span style="color: #dcaeea;">MT_NORMAL</span>               4</code>
<code><span style="color: #51afef; font-weight: bold;">#define</span> <span style="color: #dcaeea;">MT_NORMAL_WT</span>            5</code>
<code></code>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-asm"><code><span style="color: #5B6268;">/*</span></code>
<code><span style="color: #5B6268;"> * Memory region attributes for LPAE:</span></code>
<code><span style="color: #5B6268;"> *</span></code>
<code><span style="color: #5B6268;"> *   n = AttrIndx[2:0]</span></code>
<code><span style="color: #5B6268;"> *          n   MAIR</span></code>
<code><span style="color: #5B6268;"> *   DEVICE_nGnRnE  000 00000000</span></code>
<code><span style="color: #5B6268;"> *   DEVICE_nGnRE   001 00000100</span></code>
<code><span style="color: #5B6268;"> *   DEVICE_GRE     010 00001100</span></code>
<code></code>
<code><span style="color: #5B6268;"> *   NORMAL_NC      011 01000100</span></code>
<code><span style="color: #5B6268;"> *   NORMAL         100 11111111</span></code>
<code><span style="color: #5B6268;"> *   NORMAL_WT      101 10111011</span></code>
<code><span style="color: #5B6268;"> */</span></code>
<code><span style="color: #c678dd;">ldr</span> <span style="color: #51afef;">x5</span>, =MAIR(0x00, MT_DEVICE_nGnRnE) | \</code>
<code>         <span style="color: #51afef;">MAIR</span>(0x04, MT_DEVICE_nGnRE) | \</code>
<code>         <span style="color: #51afef;">MAIR</span>(0x0c, MT_DEVICE_GRE) | \</code>
<code>         <span style="color: #51afef;">MAIR</span>(0x44, MT_NORMAL_NC) | \</code>
<code>         <span style="color: #51afef;">MAIR</span>(0xff, MT_NORMAL) | \</code>
<code>         <span style="color: #51afef;">MAIR</span>(0xbb, MT_NORMAL_WT)</code>
<code><span style="color: #c678dd;">msr</span> <span style="color: #51afef;">mair</span>_el1, x5</code>
</pre>
</div>

<p>
æ¥çœ‹ä¸€çœ‹å®æœºæŠ“åˆ°çš„å¯„å­˜å™¨è®¾ç½®å€¼ï¼š (qemu aarch64)<br>
</p>
<div class="org-src-container">
<pre class="src src-shell"><code>TTBR0_EL1      0x7a13f000       2048126976</code>
<code>TTBR1_EL1      0x14c0000410c6000        93449693359267840</code>
<code>TCR_EL1        0x34b5503510     226380231952</code>
<code>PMUSERENR_EL0  0x0      0</code>
<code>MAIR_EL1       0xbbff440c0400   206705032692736</code>
<code>TCR_EL2        0x0      0</code>
<code>VTTBR_EL2      0x0      0</code>
<code>AMAIR0         0x0      0</code>
</pre>
</div>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Attr&lt;n&gt;[7:4]</th>
<th scope="col" class="org-left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0000</td>
<td class="org-left">Device memory. See encoding of Attr&lt;n&gt;[3:0] for th00RW, RW not 00 Normal memory, Outer Write-Through Transient</td>
</tr>

<tr>
<td class="org-left">0100</td>
<td class="org-left">Normal memory, Outer Non-cacheable</td>
</tr>

<tr>
<td class="org-left">01RW</td>
<td class="org-left">RW not 00 Normal memory, Outer Write-Back Transient</td>
</tr>

<tr>
<td class="org-left">10RW</td>
<td class="org-left">Normal memory, Outer Write-Through Non-transien11RW Normal memory, Outer Write-Back Non-transient</td>
</tr>
</tbody>
</table>

<table>


<colgroup>
<col  class="org-right">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Attr&lt;n&gt;[3:0]</th>
<th scope="col" class="org-left">Meaning when Attr&lt;n&gt;[7:4] is 0000 Meaning when Attr&lt;n&gt;[7:4] is not 0000</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0000</td>
<td class="org-left">Device-nGnRnE memory UNPREDICTABLE</td>
</tr>

<tr>
<td class="org-right">00RW</td>
<td class="org-left">RW not 00 UNPREDICTABLE Normal memory, Inner Write-Through Transient</td>
</tr>

<tr>
<td class="org-right">0100</td>
<td class="org-left">Device-nGnRE memory Normal memory, Inner Non-cacheable</td>
</tr>

<tr>
<td class="org-right">01RW</td>
<td class="org-left">RW not 00 UNPREDICTABLE Normal memory, Inner Write-Back Transient</td>
</tr>

<tr>
<td class="org-right">1000</td>
<td class="org-left">Device-nGRE memory Normal memory, Inner Write-Through Non-transient (RW=10RW, RW not 00 UNPREDICTABLE Normal memory, Inner Write-Through Non-transient</td>
</tr>

<tr>
<td class="org-right">1100</td>
<td class="org-left">Device-GRE memory Normal memory, Inner Write-Back Non-transient (RW=00)</td>
</tr>

<tr>
<td class="org-right">11RW</td>
<td class="org-left">RW not 00 UNPREDICTABLE Normal memory, Inner Write-Back Non-transient</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org9e0fab0" class="outline-3">
<h3 id="org9e0fab0">Normal Memory</h3>
<div class="outline-text-3" id="text-org9e0fab0">
</div>
<ul class="org-ul">
<li><a id="org9ce75b0"></a>MT_NORMAL_NC<br>
<div class="outline-text-4" id="text-org9ce75b0">
<p>
Attr&lt;n&gt; = 0x44, Normal memory, Outer Non-cacheable, Inner Non-cacheabe<br>
å°±æ˜¯æ™®é€šçš„ä¸å¸¦cacheè®¿é—®çš„ç±»å‹<br>
</p>
</div>
</li>
<li><a id="orge8b7c8b"></a>MT_NORMAL<br>
<div class="outline-text-4" id="text-orge8b7c8b">
<p>
Attr&lt;n&gt; = 0xff, Normal memory, Outer Write-Back Non-transient, Outer Read-Allocate, Outer Write-Allocate, Inner Write-Back, Inner Read-Allocate, Inner-Write-Allocate<br>
è¿™ä¸ªå°±æ˜¯å¸¦cacheçš„æ™®é€šå†…å­˜ï¼Œé€Ÿåº¦æœ€å¿«, è¯»å†™éƒ½æ˜¯å…ˆç»è¿‡cacheã€‚<br>
</p>
</div>
</li>
<li><a id="orga8881d9"></a>MT_NORMAL_WT<br>
<div class="outline-text-4" id="text-orga8881d9">
<p>
Attr&lt;n&gt; = 0xbb, Normal memory, Outer Write-Through Non-transient, Outer Read-Allocate, Outer Write-Allocate, Inner Write-Through, Inner Read-Allocate, Inner-Write-Allocate<br>
è¿™ä¸ªä¹Ÿæ˜¯å¸¦cacheçš„è®¾ç½®ï¼Œè¯»å–æ—¶ä¼šç»è¿‡cacheï¼Œå†™å…¥æ—¶åˆ™ä¸ç»è¿‡cache<br>
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-org4b45c3a" class="outline-3">
<h3 id="org4b45c3a">Device Memory</h3>
<div class="outline-text-3" id="text-org4b45c3a">
</div>
<ul class="org-ul">
<li><a id="org2cf8342"></a>GRE<br>
<div class="outline-text-4" id="text-org2cf8342">
<p>
ref to <a href="https://developer.arm.com/documentation/den0024/a/Memory-Ordering/Memory-types/Device-memory?lang=en">ARM Cortex-A Series Programmer's Guide for ARMv8-A#Device memory</a><br>
</p>
<dl class="org-dl">
<dt>G</dt><dd>Gathering<br>
è¿™ä¸ªå±æ€§å†³å®šäº†å¤šæ¬¡è®¿é—®æ˜¯å¦å¯ä»¥åˆå¹¶æˆä¸€æ¬¡æ€»çº¿è®¿é—®ã€‚å¦‚æœåœ°å€è¢«æ ‡è®°ä¸ºnGï¼Œé‚£ä¹ˆæ€»çº¿ä¸Šçš„ä¼ è¾“å°±å¿…é¡»å’Œç¨‹åºæŒ‡å®šçš„ä¼ è¾“ç›¸ä¸€è‡´<br></dd>
<dt>R</dt><dd>Re-ordering<br>
è¿™ä¸ªå±æ€§å†³å®šäº†è®¾å¤‡æ˜¯å¦ä¼šå¯¹ä¼ è¾“è¿›è¡Œé‡æ–°æ’åºï¼Œå¦‚æœè®¾ç½®ä¸ºnR,é‚£ä¹ˆå¯¹äºæœ¬å—åœ°å€ç©ºé—´çš„è®¿é—®å°±<br></dd>
</dl>
<p>
ä¼šå…¨éƒ¨æŒ‰ç…§ç¨‹åºä¸­çš„é¡ºåºæ¥è¿›è¡Œè®¿é—®ã€‚è¿™å—å†…å­˜çš„å¤§å°æ—¶ç”±å…·ä½“å¹³å°å†³å®šçš„ï¼Œå¦‚æœè¿™ä¸ªblockå¾ˆå¤§ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§å°†ä¼šè¦†ç›–å¤šä¸ªé¡µé¢é¡¹ã€‚<br>
</p>
<dl class="org-dl">
<dt>E</dt><dd>Early Write Acknowledgement<br>
è¿™ä¸ªå±æ€§å†³å®šäº†åœ¨å¤„ç†å™¨é¡¹ä»è®¾å¤‡å†™å…¥æ—¶æ˜¯å¦å…è®¸ä»ä¸­é—´çš„ç¼“å†²bufferå‘é€å†™å…¥å®Œæˆçš„åº”ç­”ä¿¡å·ã€‚å¦‚æœæŸä¸ªåœ°å€è¢«æ ‡è®°ä¸ºnEï¼Œ<br>
é‚£ä¹ˆè¿™ä¸ªä¿¡å·å°±å¿…é¡»ç”±ä»å¤–è®¾è®¾å¤‡å‘å‡ºã€‚å¦‚æœè¢«æ ‡è®°ä¸ºEï¼Œé‚£ä¹ˆè¿™ä¸ªä¿¡å·å°±å¯ä»¥ç”±ä¸­é—´çš„äº’è”ä¸­çš„bufferæ¥å‘å‡ºã€‚<br></dd>
</dl>
</div>
</li>
</ul>
</div>
<div id="outline-container-org54576f0" class="outline-3">
<h3 id="org54576f0">Strongly Ordered Memory :: ARMv7 platform, merge into Device Memory</h3>
</div>
</div>

<div id="outline-container-orgaa3fb81" class="outline-2">
<h2 id="orgaa3fb81">MMU table</h2>
<div class="outline-text-2" id="text-orgaa3fb81">
</div>
<div id="outline-container-orgeb7c5a0" class="outline-3">
<h3 id="orgeb7c5a0">Input Address size limit.</h3>
<div class="outline-text-3" id="text-orgeb7c5a0">
<p>
é€šè¿‡TCR_ELx.T0SZ å¯ä»¥æ§åˆ¶ç³»ç»Ÿè¿›è¡Œæ˜ å°„çš„åœ°å€èŒƒå›´ï¼Œè®¡ç®—æ–¹æ³• size = 2 ^(64 - TCR_ELx.T0SZ).<br>
é»˜è®¤å€¼ä¸º0ï¼Œå¯ç”¨æœ€å¤§æ”¯æŒçš„åœ°å€èŒƒå›´ï¼Œä¸€èˆ¬ä¸éœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œå½“éœ€è¦é™åˆ¶åœ°å€èŒƒå›´æ—¶å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¯„å­˜å™¨æ¥æ§åˆ¶.<br>
</p>

<div id="orgdfb2aa4" class="figure">
<p><img src="assets/2021-11-04_18-44-51_screenshot.png" alt="2021-11-04_18-44-51_screenshot.png"><br>
</p>
</div>
</div>
</div>

<div id="outline-container-org3620f1d" class="outline-3">
<h3 id="org3620f1d">Translate table</h3>
<div class="outline-text-3" id="text-org3620f1d">
<p>
VMSAv8-64 translation table format descriptors<br>
<img src="assets/11_Translation_table_format.png" alt="11_Translation_table_format.png"><br>
</p>
</div>

<ul class="org-ul">
<li><a id="org49983e3"></a>An invalid or fault entry.<br>
<div class="outline-text-4" id="text-org49983e3">
<p>
æœ€ä½ä½ä¸º0è¡¨ç¤ºæ— æ•ˆçš„è¡¨é¡¹ï¼Œå½“è®¿é—®è¯¥åœ°å€æ—¶ï¼Œç³»ç»Ÿå°†ä¼šäº§ç”ŸåŒæ­¥çš„data abort.<br>
</p>
</div>
</li>
<li><a id="org8d792b8"></a>A table entry, that points to the next-level translation table.<br>
<div class="outline-text-4" id="text-org8d792b8">
<p>
table entryè¡¨ç¤ºè¿˜æœ‰ä¸‹ä¸€çº§çš„æ˜ å°„è¡¨éœ€è¦å»æŸ¥è¯¢ï¼Œå°±åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¸‹çº§åœ°å€è®°å½•ï¼ŒåŠŸèƒ½æ¯”è¾ƒç®€å•.<br>
</p>

<div id="orgbc57ab3" class="figure">
<p><img src="assets/2021-11-04_18-48-42_screenshot.png" alt="2021-11-04_18-48-42_screenshot.png"><br>
</p>
</div>
</div>
</li>

<li><a id="org30645f5"></a>A block entry, that defines the memory properties for the access.<br>
<div class="outline-text-4" id="text-org30645f5">
<p>
block entryè¡¨ç¤ºä¸€ä¸ªå…·ä½“çš„æ˜ å°„é¡¹ï¼Œå½“ç³»ç»Ÿè®°å½•äº†æœ€ç»ˆæ˜ å°„åˆ°çš„åœ°å€ï¼Œä»¥åŠä¸€äº›å±æ€§çš„é…åˆ¶ï¼Œmmuè®¾ç½®çš„å†…å­˜å±æ€§å…¨éƒ¨éƒ½å¯ä»¥ä»è¿™é‡ŒæŸ¥åˆ°.<br>
</p>

<div id="org3f5fc1a" class="figure">
<p><img src="assets/2021-11-04_16-25-15_screenshot.png" alt="2021-11-04_16-25-15_screenshot.png"><br>
</p>
</div>
</div>
</li>
</ul>
</div>

<div id="outline-container-org6fbc205" class="outline-3">
<h3 id="org6fbc205">example</h3>
<div class="outline-text-3" id="text-org6fbc205">
<p>
ä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“çš„æ˜ å°„è¡¨çš„ä¾‹å­ï¼Œé¢—ç²’åº¦ï¼š4KB<br>
</p>
</div>
<ul class="org-ul">
<li><a id="org6f5cd4f"></a>ç›¸å…³å¯„å­˜å™¨å€¼ä»¥åŠæ˜ å°„è¡¨å†…å®¹<br>
<div class="outline-text-4" id="text-org6f5cd4f">
<div class="org-src-container">
<pre class="src src-bash"><code>i r TCR_EL2</code>
<code>TCR_EL2     0x0007FFF78081351C</code>
<code></code>
<code>i r TTBR0_EL2</code>
<code>TTBR0_EL2   0x00000000FFFF0000</code>
<code></code>
<code>x/16g SP:0x00000000FFFF0000</code>
<code>SP:0x00000000FFFF0000:  0x00000000FFFF1003  0x0060000040000401  0x0000000080000711  0x00000000C0000711  0x0000000100000711  0x0000000140000711  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF0040:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code></code>
<code>x/256g SP:0x00000000FFFF1000</code>
<code>SP:0x00000000FFFF1000:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1040:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1080:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF10C0:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1100:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1140:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1180:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF11C0:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1200:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1240:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1280:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF12C0:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1300:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1340:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1380:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF13C0:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1400:  0x0060000010000401  0x0060000010200401  0x0060000010400401  0x0060000010600401  0x0060000010800401  0x0060000010A00401  0x0060000010C00401  0x0060000010E00401</code>
<code>SP:0x00000000FFFF1440:  0x0060000011000401  0x0060000011200401  0x0060000011400401  0x0060000011600401  0x0060000011800401  0x0060000011A00401  0x0060000011C00401  0x0060000011E00401</code>
<code>SP:0x00000000FFFF1480:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF14C0:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1500:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1540:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1580:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF15C0:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1600:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1640:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1680:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF16C0:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1700:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1740:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF1780:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
<code>SP:0x00000000FFFF17C0:  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000  0x0000000000000000</code>
</pre>
</div>
</div>
</li>
<li><a id="orgd62de4d"></a>TCR_EL2<br>
<div class="outline-text-4" id="text-orgd62de4d">
<p>
ä»è¿™ä¸ªå¯„å­˜å™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š<br>
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">field</td>
<td class="org-right">value</td>
<td class="org-left">meaning</td>
</tr>

<tr>
<td class="org-left">TCR_EL2.TG0</td>
<td class="org-right">0x0</td>
<td class="org-left">4KB Granule size</td>
</tr>

<tr>
<td class="org-left">TCR_EL2.T0SZ</td>
<td class="org-right">0x1C</td>
<td class="org-left">å¯ç”¨åœ°å€èŒƒå›´ 0 ~ 2^(64-28)</td>
</tr>
</tbody>
</table>

<p>
å¯¹äº4KBçš„é¢—ç²’åº¦, æ¯ä¸€çº§çš„åœ°å€èŒƒå›´å¦‚ä¸‹å›¾<br>
</p>

<div id="org939bede" class="figure">
<p><img src="assets/2021-11-04_15-45-13_screenshot.png" alt="2021-11-04_15-45-13_screenshot.png"><br>
</p>
</div>
</div>
</li>
<li><a id="orgef6687b"></a>mmu è¡¨é¡¹è§£é‡Š<br>
<div class="outline-text-4" id="text-orgef6687b">
<p>
åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œmmu tableä½äº 0xffff0000 çš„ä½ç½®ï¼Œæ¯ä¸ªè¡¨é¡¹æœ‰64bité•¿åº¦, ä½¿ç”¨4KBçš„é¢—ç²’åº¦.<br>
</p>

<ol class="org-ol">
<li>T0SZ<br>
= 0b011100 = 28, ç”±æ­¤å¯å¾—åœ°å€èŒƒå›´ä¸º 0 ~ 0x1000000000<br></li>
<li>å¯¹äºæ¯ä¸€é¡¹<br>
bit[0]: indicates whether the descriptor is valid, å¯¹äºæœªæ˜ å°„çš„é¡¹ï¼Œè®¿é—®æ˜¯ä¼šè§¦å‘data abort.<br>
Bit[1] of the descriptor indicates the descriptor type. 0: Block, 1: Table<br></li>

<li>è§£æ<br>
ç¬¬ä¸€é¡¹ï¼š 0x00000000FFFF1003: è¡¨ç¤ºå­˜åœ¨level 0æ˜ å°„, tableç±»å‹, ä¸‹çº§tableåœ°å€åœ¨ 0x00000000FFFF1000<br>
    64é¡¹ï¼š 0x00000000FFFF1400 :  0x0060000010000401: blockç±»å‹, æ¯ä¸ªblockå¤§å°2MB,æ ¹æ®åœ°å€è®¡ç®—ï¼Œå¯¹åº”çš„èŒƒå›´æ˜¯ [0x10000000 , 0x10200000) , Upper attribute: [63:51] = 0b0000000001100, Lower attribute: [11:2)] = 0b0100000000 XN,PXN,AF<br>
ç¬¬äºŒé¡¹ï¼š 0x0060000040000401: Blockç±»å‹ï¼Œæ¯ä¸ªblock 1GBå¤§å°æ ¹æ®åœ°å€è®¡ç®—ï¼Œå¯¹åº”çš„èŒƒå›´æ˜¯ [0x40000000 , 0x8000000)<br>
å‰©ä½™é¡¹ï¼› å’Œç¬¬äºŒé¡¹ç±»ä¼¼ã€‚<br></li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
è¯¦è§ARMå®˜æ–¹æ–‡æ¡£DEN0024A_v8_architecture_PG.pdf 13.1 Memory types<br>
<a href="https://developer.arm.com/documentation/101811/0101">https://developer.arm.com/documentation/101811/0101</a><br>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<script src="https://utteranc.es/client.js"
    repo="schspa/schspa.github.io"
    issue-term="title"
    label="âœ¨ğŸ’¬âœ¨"
    theme="github-light"
    crossorigin="anonymous"
    async>
</script>
<div class="me">
  <span><b>Contact me via :)</b><span>
  <div class="contact">
    <a id="email" href="mailto:schspa@gmail.com" target="_blank"><i class="fab fa-mailchimp animated heartBeat delay-2s slower"></i></a>
    <a id="github" href="//github.com/schspa" target="_blank"><i class="fab fa-github animated heartBeat delay-2s slower"></i></a>
  </div>
</div>

<div id="jinrishici-sentence" style="font-weight: 700;">è™šæ€€ä¹ƒè‹¥è°·ï¼Œæ°´æ·±åˆ™æµç¼“ã€‚</div>
<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
</div>
</body>
</html>
