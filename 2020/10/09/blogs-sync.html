<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2023-10-20 Fri 17:00 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Use Github Action to Sync blogs</title>
<meta name="author" content="schspa" />
<meta name="description" content="Use Github Action to Sync blogs" />
<meta name="generator" content="Org Mode" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="shortcut icon" href="/images/rose-red.png" type="image/x-icon" />
<link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="/css/animate.min.css" />
<link rel="stylesheet" href="/css/all.min.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css" />
<link rel="stylesheet" type="text/css" href="/css/navbar.css" />
<script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script src="/js/darkreader.js"></script>
<script src="/user.config.js"></script>
<script src="/js/main.js"></script>
</head>
<body>
<div id="preamble" class="status">
<div class="mobile-container">
  <!-- Top Navigation Menu -->
  <div class="topnav">
    <div id="header">
      <a href="/" class="logo">Schspa's Blog</a>
      <a href="javascript:void(0);" class="icon" onclick="toggleheader()">
        <i class="fa fa-bars"></i>
      </a>
    </div>
    <div id="nav_headers">
      <a href="/sitemap.html" class="menu-item">Categories</a>
    </div>
  </div>
  <!-- End smartphone / tablet look -->
</div>

<header id="header" class="header">
  <div class="logo-wrapper">
    <a href="/" class="logo">Schspa's Blogs</a>
  </div>

  <nav class="site-navbar">
    <ul id="menu" class="menu">
      <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li>
      <li class="menu-item">
        <a class="menu-item-link" href="/sitemap.html">Categories</a>
      </li>
    </ul>
  </nav>
</header>
</div>
<div id="content" class="content">
<h1 class="title">Use Github Action to Sync blogs</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org871799c">ç¯å¢ƒä»‹ç»</a></li>
<li><a href="#orgdd24491">Runner é…ç½®</a>
<ul>
<li><a href="#org0910a68">å®‰è£…github runner</a></li>
<li><a href="#orgd1f9a54">è‡ªå¯åŠ¨runner</a></li>
<li><a href="#org45f97c8">runneræƒé™è®¾ç½®</a></li>
</ul>
</li>
<li><a href="#org610f62f">è®¾ç½®åœ¨pushæ“ä½œæ—¶è‡ªåŠ¨æ›´æ–°</a></li>
</ul>
</div>
</div>

<div id="outline-container-org871799c" class="outline-2">
<h2 id="org871799c">ç¯å¢ƒä»‹ç»</h2>
<div class="outline-text-2" id="text-org871799c">
<p>
æˆ‘è‡ªå·±çš„Blogæ˜¯é€šè¿‡<a href="https://orgmode.org/manual/Publishing.html">org-publish</a>æ¥ç”Ÿæˆçš„, ç”Ÿæˆä¹‹åéƒ¨å±åœ¨<a href="http://schspa.tk">schspa.tk</a>ä»¥åŠ<a href="http://schspa.github.io">github io</a>ä¸Šï¼Œä¹‹å‰æ¯æ¬¡æ›´æ–°åšå®¢ä¹‹åï¼Œæˆ‘éƒ½ä¼šå‘ä¸¤ä¸ªæœåŠ¡å™¨ä¸Šå»åŒæ­¥ä¸€ä¸‹åšå®¢ï¼Œ<br>
ç°åœ¨githubæœ‰äº†<a href="https://github.com/features/actions">github action</a> å¹¶ä¸”å¯ä»¥æ”¯æŒä½¿ç”¨è‡ªå·±runneræœåŠ¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨github actionæ¥åŠ¨æ€åœ¨æ›´æ–°github actionæ—¶è‡ªåŠ¨æ›´æ–°åšå®¢äº†ã€‚<br>
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">åšå®¢</td>
<td class="org-left">æœåŠ¡å™¨</td>
<td class="org-left">ç‰ˆæœ¬</td>
</tr>

<tr>
<td class="org-left"><a href="http://schspa.tk">schspa.tk</a></td>
<td class="org-left">schspa.tk</td>
<td class="org-left">Ubuntu 18.04</td>
</tr>

<tr>
<td class="org-left"><a href="https://schspa.github.io">schspa.github.io</a></td>
<td class="org-left">github</td>
<td class="org-left">github</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgdd24491" class="outline-2">
<h2 id="orgdd24491">Runner é…ç½®</h2>
<div class="outline-text-2" id="text-orgdd24491">
</div>
<div id="outline-container-org0910a68" class="outline-3">
<h3 id="org0910a68">å®‰è£…github runner</h3>
<div class="outline-text-3" id="text-org0910a68">
<p>
æŒ‰ç…§ä¸‹é¢çš„å®˜æ–¹æ–‡æ¡£å¯ä»¥å¾ˆå®¹æ˜“çš„éƒ¨å±å¥½runnerï¼Œéƒ¨å±è¿‡ç¨‹å¾ˆé¡ºåˆ©ï¼Œæ²¡æœ‰é‡åˆ°ä»»ä½•é”™è¯¯<br>
<a href="https://docs.github.com/en/free-pro-team@latest/actions/hosting-your-own-runners/adding-self-hosted-runners">https://docs.github.com/en/free-pro-team@latest/actions/hosting-your-own-runners/adding-self-hosted-runners</a><br>
</p>
</div>
</div>
<div id="outline-container-orgd1f9a54" class="outline-3">
<h3 id="orgd1f9a54">è‡ªå¯åŠ¨runner</h3>
<div class="outline-text-3" id="text-orgd1f9a54">
<p>
æŒ‰ç…§å®˜æ–¹çš„wikiï¼Œlinuxä¸‹å¯ä»¥ä½¿ç”¨å®˜æ–¹è‡ªå·±ç»™çš„systemdæœåŠ¡é…ç½®æ–‡ä»¶å°±å¯ä»¥é…ç½®å¥½å¼€æœºè‡ªå¯åŠ¨<br>
<a href="https://docs.github.com/en/free-pro-team@latest/actions/hosting-your-own-runners/configuring-the-self-hosted-runner-application-as-a-service">https://docs.github.com/en/free-pro-team@latest/actions/hosting-your-own-runners/configuring-the-self-hosted-runner-application-as-a-service</a><br>
</p>
<div class="org-src-container">
<pre class="src src-bash"><code>ubuntu@ip-172-31-43-98:~/actions-runner$ sudo ./svc.sh install</code>
<code>Creating launch runner<span class="org-keyword"> in</span> /etc/systemd/system/actions.runner.schspa-schspa.github.io.schspa.tk.service</code>
<code>Run as user: ubuntu</code>
<code>Run as uid: 1000</code>
<code>gid: 1000</code>
<code>Created symlink /etc/systemd/system/multi-user.target.wants/actions.runner.schspa-schspa.github.io.schspa.tk.service &#8594; /etc/systemd/system/actions.runner.schspa-schspa.github.io.schspa.tk.service.</code>
<code>ubuntu@ip-172-31-43-98:~/actions-runner$ sudo ./svc.sh start</code>
<code></code>
<code>/etc/systemd/system/actions.runner.schspa-schspa.github.io.schspa.tk.service</code>
<code>&#9679; actions.runner.schspa-schspa.github.io.schspa.tk.service - Github sync Runner</code>
<code>   Loaded: loaded (/etc/systemd/system/actions.runner.schspa-schspa.github.io.schspa.tk.service; enabled; vendor preset: enabled)</code>
<code>   Active: active (running) since Fri 2020-10-09 22:54:47 CST; 21ms ago</code>
<code> Main PID: 2032 (runsvc.sh)</code>
<code>    Tasks: 2 (<span class="org-builtin">limit</span>: 1140)</code>
<code>   CGroup: /system.slice/actions.runner.schspa-schspa.github.io.schspa.tk.service</code>
<code>           &#9500;&#9472;2032 /bin/bash /home/ubuntu/actions-runner/runsvc.sh</code>
<code>           &#9492;&#9472;2038 /bin/bash /home/ubuntu/actions-runner/runsvc.sh</code>
<code></code>
<code>Oct 09 22:54:47 ip-172-31-43-98 systemd[1]: Started Github sync Runner.</code>
<code>Oct 09 22:54:47 ip-172-31-43-98 runsvc.sh[2032]: .path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</code>
</pre>
</div>
</div>
</div>

<div id="outline-container-org45f97c8" class="outline-3">
<h3 id="org45f97c8">runneræƒé™è®¾ç½®</h3>
<div class="outline-text-3" id="text-org45f97c8">
<p>
ç”±äºrunnerç›´æ¥å®‰è£…åœ¨äº†hostæœºä¸Šï¼Œæ²¡æœ‰dockerç­‰å®¹å™¨çš„ä¿æŠ¤ï¼Œæ‰€ä»¥æƒé™æ–¹é¢è¦æ ¼å¤–è®¾ç½®å¥½ï¼Œæ”¾ç½®ä¸æ³•åˆ†å­åˆ©ç”¨è¿™ä¸ªrunneræ¥æ”»å‡»æœåŠ¡å™¨ã€‚<br>
</p>

<p>
ä¸‹é¢æ˜¯æˆ‘è‡ªå·±çš„æƒé™è®¾ç½®ï¼Œåªå…è®¸è‡ªå·±ä½¿ç”¨<br>
</p>

<div id="org886b88c" class="figure">
<p><img src="assets/github-selfhost-action-setup.jpg" alt="github-selfhost-action-setup.jpg"><br>
</p>
<p><span class="figure-number">Figure 1: </span>runneræƒé™è®¾ç½®</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org610f62f" class="outline-2">
<h2 id="org610f62f">è®¾ç½®åœ¨pushæ“ä½œæ—¶è‡ªåŠ¨æ›´æ–°</h2>
<div class="outline-text-2" id="text-org610f62f">
<p>
é…ç½®æ–‡ä»¶ï¼š<br>
</p>
<div class="org-src-container">
<pre class="src src-yaml"><code><span class="org-variable-name">name</span>: sync to schspa.tk</code>
<code></code>
<code><span class="org-constant">on</span>:</code>
<code>  <span class="org-variable-name">push</span>:</code>
<code>    <span class="org-variable-name">branches</span>:</code>
<code>    - master</code>
<code></code>
<code><span class="org-variable-name">jobs</span>:</code>
<code>  <span class="org-variable-name">sync</span>:</code>
<code>    <span class="org-variable-name">runs-on</span>: schspa.tk</code>
<code></code>
<code>    <span class="org-variable-name">steps</span>:</code>
<code>    - <span class="org-variable-name">name</span>: Sync blogs</code>
<code>      <span class="org-variable-name">run</span>: bash -c <span class="org-string">"cd ~/sites &amp;&amp; git fetch &amp;&amp; git reset --hard origin/master"</span></code>
</pre>
</div>
<p>
å¾ˆç®€å•ï¼Œä¸Šé¢çš„é…ç½®æ–‡ä»¶å‘Šè¯‰githubï¼Œåœ¨æ”¶åˆ°masteråˆ†æ”¯çš„pushäº‹ä»¶æ—¶ï¼Œå°±è‡ªåŠ¨åœ¨æ ‡ç­¾ä¸ºschspa.tkçš„runnerä¸Šè‡ªåŠ¨æ‰§è¡Œä¸‹é¢çš„Sync blogsçš„æ­¥éª¤ã€‚<br>
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<script src="https://utteranc.es/client.js"
    repo="schspa/schspa.github.io"
    issue-term="title"
    label="âœ¨ğŸ’¬âœ¨"
    theme="github-light"
    crossorigin="anonymous"
    async>
</script>
<div class="me">
  <span><b>Contact me via :)</b><span>
  <div class="contact">
    <a id="email" href="mailto:schspa@gmail.com" target="_blank"><i class="fab fa-mailchimp animated heartBeat delay-2s slower"></i></a>
    <a id="github" href="//github.com/schspa" target="_blank"><i class="fab fa-github animated heartBeat delay-2s slower"></i></a>
  </div>
</div>

<div id="jinrishici-sentence" style="font-weight: 700;">è™šæ€€ä¹ƒè‹¥è°·ï¼Œæ°´æ·±åˆ™æµç¼“ã€‚</div>
<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
</div>
</body>
</html>